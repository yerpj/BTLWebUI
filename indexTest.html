
<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8"/>
    <link rel="stylesheet" type="text/css" href="style.css"/>
    <title>LED control</title>
    <script>
     // var Ww = window.innerWidth;
     // var Wh = window.innerHeight;
    </script>
  </head>
  <body>
    <div  style="text-align:center"><h1>LED bleue</h1>
      <p> <input type="button" class="bouton" value="LED" id="buttoncb" align="center"></p>
      <form>
        <output name="EspruinoStatus"></output><br>
        Send command to Espruino:<br>
        <input type="text" id="EspruinoCMD" size="35"><input type="button" value="send" id="EspruinoSend" disabled><input type="button" value="clear" id="EspruinoRXClear"><br>
        <textarea rows="10" cols="45" id="EspruinoRX" readonly></textarea>
     </form>
   </div>

    <script src="http://code.jquery.com/jquery-1.10.1.min.js"></script>
    <script src="/socket.io/socket.io.js"></script>
    <script>
      var socket=io.connect();

      socket.on('connect',function(){
        document.getElementById('EspruinoSend').disabled=false;
      });

      socket.on('SC_OUTPUT1',function(value){
        document.getElementById('buttoncb').value=value;
        var color=0;
        if(value=="ON")
          color="#0033CC";
        else
          color="#A80000";
        document.getElementById('buttoncb').style.background=color;
      });

      socket.on('SC_EspruinoRX',function(value){
        var EspruinoRXjs=document.getElementById('EspruinoRX');
        EspruinoRXjs.value+=value;
        EspruinoRXjs.scrollTop = EspruinoRXjs.scrollHeight;
      });

      socket.on('SC_EspruinoAvailable',function(value){
        document.getElementById('EspruinoCMD').disabled=!value;
        document.getElementById('EspruinoSend').disabled=!value;
      });


      $('#buttoncb').click(function(){socket.emit('CS_OUTPUT1','clicked');});
      $('#EspruinoSend').click(function(){socket.emit('CS_ESPRUINO_CMD',document.getElementById("EspruinoCMD").value);});
      $('#EspruinoRXClear').click(function(){document.getElementById('EspruinoRX').value="";});
      $('#EspruinoCMD').keydown(function(event){
        if(event.keyCode == 13){
          socket.emit('CS_ESPRUINO_CMD',document.getElementById("EspruinoCMD").value);
          return false;
        }
      });
    </script>
  </body>
</html>
